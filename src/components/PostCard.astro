---
import { type CollectionEntry, getEntry } from "astro:content"
import type { AuthorProfile, PostData } from "../scripts/types/post_types"
import PostTypeTag from "./PostTypeTag.astro"

interface Props {
    post: CollectionEntry<'posts'>
}

const { post } = Astro.props
const data: PostData = post.data
const authorEntry = await getEntry("authors", data.author.id)
const author: AuthorProfile = authorEntry.data

const formatedDate = data.date.toLocaleDateString()
---

<li class="py-4">
    <a href={`post/${post.slug}`}>
        <div class="flex flex-col">
            <span class="flex flex-row items-center space-x-3">
                <h1 class="group-hover:underline" transition:name={post.id}>{data.title}</h1>
                <span transition:name={post.id + data.postType}>
                    <PostTypeTag text={data.postType}/>
                </span>
            </span>
            <small>{author.name} ‚óè {formatedDate}</small>
            <div>
                <p class="text-ellipsis overflow-hidden">
                    {data.description}
                </p>
            </div>
        </div>
    </a>
</li>